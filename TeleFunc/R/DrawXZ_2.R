Sandbar<-list()
Sandbar$colors<-c("grey","orange")
Sandbar$borders<-c("darkgrey","darkgrey")


Sandbar$Body <- cbind(c(0.655, 0.701, 0.74, 0.777, 0.802, 0.821, 
                        0.828, 0.82, 0.794, 0.754, 0.704, 0.654, 0.608, 0.562, 
                        0.516, 0.472, 0.435, 0.4, 0.369, 0.342, 0.326, 0.301, 
                        0.27, 0.232, 0.203, 0.179, 0.162, 0.151, 0.143, 0.136, 
                        0.132, 0.131, 0.132, 0.131, 0.124, 0.112, 0.096, 0.078, 
                        0.061, 0.046, 0.016, -0.037, -0.1, -0.162, -0.209, -0.246, 
                        -0.266, -0.278, -0.289, -0.301, -0.313, -0.33, -0.344, 
                        -0.357, -0.367, -0.375, -0.382, -0.394, -0.417, -0.446, 
                        -0.469, -0.486, -0.498, -0.526, -0.575, -0.642, -0.715, 
                        -0.78, -0.832, -0.873, -0.906, -0.932, -0.945, -0.945, 
                        -0.939, -0.928, -0.916, -0.902, -0.894, -0.89, -0.889, 
                        -0.881, -0.867, -0.855, -0.846, -0.819, -0.774, -0.72, 
                        -0.68, -0.653, -0.641, -0.647, -0.658, -0.669, -0.666, 
                        -0.66, -0.645, -0.627, -0.602, -0.566, -0.533, -0.506, 
                        -0.494, -0.484, -0.473, -0.453, -0.424, -0.397, -0.382, 
                        -0.376, -0.371, -0.363, -0.359, -0.353, -0.341, -0.321, 
                        -0.297, -0.275, -0.26, -0.243, -0.221, -0.197, -0.184, 
                        -0.173, -0.162, -0.148, -0.138, -0.131, -0.12, -0.104, 
                        -0.082, -0.064, -0.051, -0.043, -0.035, -0.022, 0.013, 
                        0.075, 0.16, 0.225, 0.257, 0.263, 0.263, 0.263, 0.266, 
                        0.275, 0.287, 0.301, 0.322, 0.35, 0.377, 0.399, 0.415, 
                        0.43, 0.438, 0.446, 0.454, 0.466, 0.497, 0.546, 0.607), 
                      rep(0, 161),
                      c(-0.067, -0.056, -0.046, -0.037, -0.026, 
                        -0.014, -0.002, 0.01, 0.027, 0.049, 0.078, 0.105, 
                        0.131, 0.154, 0.172, 0.185, 0.195, 0.204, 0.21, 0.222, 
                        0.238, 0.284, 0.337, 0.397, 0.439, 0.467, 0.479, 
                        0.48, 0.476, 0.461, 0.435, 0.402, 0.368, 0.337, 0.308, 
                        0.284, 0.263, 0.244, 0.223, 0.204, 0.184, 0.169, 
                        0.154, 0.142, 0.128, 0.117, 0.11, 0.111, 0.122, 0.134, 
                        0.146, 0.152, 0.151, 0.142, 0.12, 0.104, 0.084, 0.074, 
                        0.065, 0.062, 0.06, 0.058, 0.071, 0.098, 0.14, 0.187, 
                        0.229, 0.267, 0.294, 0.32, 0.338, 0.346, 0.341, 0.331, 
                        0.321, 0.305, 0.284, 0.258, 0.235, 0.22, 0.213, 0.216, 
                        0.22, 0.225, 0.222, 0.19, 0.146, 0.093, 0.054, 0.012, 
                        -0.029, -0.071, -0.109, -0.146, -0.17, -0.183, -0.183, 
                        -0.176, -0.162, -0.136, -0.103, -0.067, -0.041, -0.031, 
                        -0.029, -0.032, -0.034, -0.04, -0.046, -0.055, -0.067, 
                        -0.087, -0.108, -0.124, -0.13, -0.117, -0.093, -0.071, 
                        -0.064, -0.065, -0.067, -0.075, -0.085, -0.1, -0.114, 
                        -0.13, -0.147, -0.159, -0.159, -0.152, -0.136, -0.12, 
                        -0.105, -0.097, -0.103, -0.111, -0.123, -0.132, -0.138, 
                        -0.144, -0.156, -0.208, -0.283, -0.369, -0.433, -0.467, 
                        -0.478, -0.469, -0.443, -0.396, -0.339, -0.279, -0.223, 
                        -0.168, -0.126, -0.103, -0.096, -0.096, -0.093, -0.087, 
                        -0.078))

Sandbar$tag <- cbind(c(0.17, 0.17, 0.19, 0.22, 0.29, 0.29, 0.22, 0.19) - 0.03,
                     rep(0, 8),
                     c(0.225, 0.205, 0.19, 0.19, 0.21, 0.22, 0.24, 0.24) + 0.05)



RedDrum<-list()
RedDrum$colors<-c("lightsalmon4","lightsalmon4","lightsalmon4","lightsalmon4","lightsalmon4","lightsalmon3","seashell2","seashell2","black","goldenrod4","black","lightsalmon4","black","black","orange")
RedDrum$borders<-c(NA,NA,NA,NA,NA,NA,NA,"seashell2",NA,"goldenrod4",NA,NA,NA,NA,NA)

RedDrum$fin1 <- cbind(c(-0.296, -0.354, -0.374, -0.39, -0.398, -0.41, 
                        -0.391, -0.379, -0.368, -0.354, -0.338, -0.32, -0.302, 
                        -0.286, -0.27, -0.254, -0.239, -0.223, -0.209, -0.192, 
                        -0.173, -0.155, -0.136, -0.125, -0.116, -0.108, -0.107, 
                        -0.109, -0.12, -0.179, -0.237) * -1, 0, c(0.153, 0.153, 
                                                                  0.151, 0.152, 0.158, 0.172, 0.297, 0.325, 0.354, 0.38, 
                                                                  0.402, 0.42, 0.434, 0.439, 0.434, 0.419, 0.397, 0.376, 
                                                                  0.357, 0.338, 0.323, 0.307, 0.292, 0.282, 0.27, 0.263, 
                                                                  0.256, 0.25, 0.25, 0.25, 0.252))
RedDrum$fin2 <- cbind(c(0.036, -0.071, -0.043, -0.018, 0.004, 0.028, 
                        0.047, 0.072, 0.098, 0.128, 0.159, 0.211, 0.283, 0.366, 
                        0.445, 0.498, 0.526, 0.535, 0.541, 0.538, 0.528, 0.508, 
                        0.47, 0.312, 0.164) * -1, 0, c(0.187, 0.246, 0.274, 0.298, 
                                                       0.319, 0.334, 0.341, 0.34, 0.333, 0.324, 0.312, 0.291, 
                                                       0.259, 0.219, 0.176, 0.144, 0.119, 0.103, 0.093, 0.086, 
                                                       0.081, 0.075, 0.068, 0.099, 0.139))
RedDrum$fin3 <- cbind(c(-0.411, -0.427, -0.416, -0.399, -0.377, -0.353, 
                        -0.325, -0.297, -0.272, -0.249, -0.231, -0.226, -0.227, 
                        -0.235, -0.247, -0.256, -0.264, -0.268, -0.273, -0.282, 
                        -0.298, -0.318, -0.337, -0.348, -0.373, -0.394) * -1, 
                      0, c(-0.222, -0.243, -0.27, -0.302, -0.331, -0.359, -0.385, 
                           -0.409, -0.43, -0.446, -0.453, -0.439, -0.418, -0.387, 
                           -0.353, -0.325, -0.3, -0.284, -0.275, -0.273, -0.273, 
                           -0.268, -0.254, -0.236, -0.219, -0.212))
RedDrum$fin4 <- cbind(c(0.178, 0.155, 0.182, 0.213, 0.247, 0.285, 
                        0.32, 0.351, 0.375, 0.391, 0.401, 0.407, 0.412, 0.417, 
                        0.419, 0.417, 0.409, 0.39, 0.36, 0.33, 0.264, 0.213) * 
                        -1, 0, c(-0.147, -0.184, -0.219, -0.252, -0.282, -0.313, 
                                 -0.337, -0.358, -0.37, -0.362, -0.339, -0.304, -0.263, 
                                 -0.228, -0.205, -0.192, -0.184, -0.173, -0.153, -0.129, 
                                 -0.119, -0.124))
RedDrum$fin5 <- cbind(c(0.603, 0.629, 0.679, 0.734, 0.792, 0.843, 
                        0.886, 0.918, 0.94, 0.954, 0.956, 0.953, 0.945, 0.936, 
                        0.931, 0.934, 0.939, 0.944, 0.948, 0.941, 0.929, 0.901, 
                        0.855, 0.802, 0.746, 0.694, 0.655, 0.619, 0.599) * -1, 
                      0, c(0.005, 0.048, 0.089, 0.132, 0.173, 0.196, 0.213, 
                           0.224, 0.227, 0.23, 0.224, 0.198, 0.155, 0.095, 0.024, 
                           -0.041, -0.101, -0.163, -0.211, -0.245, -0.263, -0.258, 
                           -0.236, -0.21, -0.177, -0.134, -0.097, -0.058, -0.023))

RedDrum$body <- cbind(c(-0.111, -0.204, -0.281, -0.366, -0.455, -0.531, 
                        -0.602, -0.668, -0.725, -0.774, -0.822, -0.86, -0.892, 
                        -0.925, -0.947, -0.952, -0.944, -0.919, -0.877, -0.823, 
                        -0.754, -0.653, -0.533, -0.398, -0.263, -0.141, -0.022, 
                        0.096, 0.212, 0.311, 0.393, 0.454, 0.507, 0.558, 0.602, 
                        0.646, 0.684, 0.712, 0.737, 0.751, 0.761, 0.765, 0.763, 
                        0.761, 0.757, 0.752, 0.746, 0.725, 0.687, 0.63, 0.55, 
                        0.47, 0.388, 0.31, 0.239, 0.163, 0.071, -0.021) * -1, 
                      0, c(-0.252, -0.258, -0.259, -0.256, -0.252, -0.243, 
                           -0.232, -0.22, -0.207, -0.197, -0.187, -0.18, -0.167, 
                           -0.148, -0.113, -0.071, -0.03, 0.011, 0.043, 0.078, 
                           0.113, 0.157, 0.201, 0.234, 0.256, 0.256, 0.241, 
                           0.215, 0.185, 0.154, 0.121, 0.094, 0.073, 0.063, 
                           0.065, 0.078, 0.1, 0.125, 0.131, 0.114, 0.068, 0.001, 
                           -0.065, -0.122, -0.158, -0.18, -0.183, -0.167, -0.148, 
                           -0.127, -0.115, -0.125, -0.143, -0.168, -0.191, -0.209, 
                           -0.228, -0.242))
RedDrum$belly <- cbind(c(0.702, 0.673, 0.632, 0.577, 0.501, 0.424, 
                         0.337, 0.242, 0.166, 0.088, 0.028, -0.023, -0.072, -0.117, 
                         -0.175, -0.235, -0.305, -0.378, -0.441, -0.497, -0.55, 
                         -0.604, -0.658, -0.724, -0.782, -0.947, -0.925, -0.892, 
                         -0.86, -0.822, -0.774, -0.725, -0.668, -0.602, -0.531, 
                         -0.455, -0.366, -0.281, -0.204, -0.111, -0.021, 0.071, 
                         0.163, 0.239, 0.31, 0.388, 0.47, 0.55, 0.63, 0.687, 0.725, 
                         0.746, 0.752, 0.757, 0.761, 0.765, 0.761) * -1, 0, c(-0.038, 
                                                                              -0.037, -0.037, -0.036, -0.037, -0.041, -0.051, -0.064, 
                                                                              -0.079, -0.089, -0.085, -0.072, -0.047, -0.016, 0.01, 
                                                                              0.022, 0.015, -0.005, -0.032, -0.059, -0.082, -0.102, 
                                                                              -0.115, -0.121, -0.121, -0.113, -0.148, -0.167, -0.18, 
                                                                              -0.187, -0.197, -0.207, -0.22, -0.232, -0.243, -0.252, 
                                                                              -0.256, -0.259, -0.258, -0.252, -0.242, -0.228, -0.209, 
                                                                              -0.191, -0.168, -0.143, -0.125, -0.115, -0.127, -0.148, 
                                                                              -0.167, -0.183, -0.18, -0.158, -0.122, -0.001, -0.068))
RedDrum$Spot1 <- cbind((cos(seq(0, 2 * pi, by = 0.1)) * 0.032 + 0.68) * 
                         -1, 0, (sin(seq(0, 2 * pi, by = 0.1)) * 0.032 + 0.032))
RedDrum$Spot2 <- cbind((cos(seq(0, 2 * pi, by = 0.1)) * 0.022 + 0.68) * 
                         -1, 0, (sin(seq(0, 2 * pi, by = 0.1)) * 0.022 + 0.032))
RedDrum$eye <- cbind((cos(seq(0, 2 * pi, by = 0.1)) * 0.027 - 0.83) * 
                       -1, 0, (sin(seq(0, 2 * pi, by = 0.1)) * 0.027 + 0.025))
RedDrum$pupil <- cbind((cos(seq(0, 2 * pi, by = 0.1)) * 0.015 - 0.83) * 
                         -1, 0, (sin(seq(0, 2 * pi, by = 0.1)) * 0.015 + 0.025))
RedDrum$fin6 <- cbind(c(-0.421, -0.4, -0.372, -0.342, -0.311, -0.283, 
                        -0.263, -0.25, -0.247, -0.259, -0.278, -0.304, -0.327, 
                        -0.351, -0.374, -0.395, -0.426, -0.455, -0.478, -0.496, 
                        -0.501, -0.499, -0.494, -0.489, -0.491, -0.496, -0.503, 
                        -0.504, -0.491, -0.472, -0.453, -0.435) * -1, 0, c(-0.003, 
                                                                           0.005, 0.013, 0.02, 0.023, 0.02, 0.004, -0.021, -0.053, 
                                                                           -0.085, -0.117, -0.143, -0.163, -0.174, -0.176, -0.173, 
                                                                           -0.168, -0.164, -0.158, -0.155, -0.149, -0.136, -0.122, 
                                                                           -0.104, -0.087, -0.075, -0.067, -0.061, -0.049, -0.038, 
                                                                           -0.024, -0.012))
RedDrum$opercle <- cbind(c(-0.678, -0.643, -0.609, -0.583, -0.561, 
                           -0.538, -0.518, -0.504, -0.493, -0.488, -0.488, -0.489, 
                           -0.496, -0.507, -0.52, -0.532, -0.522, -0.51, -0.497, 
                           -0.486, -0.479, -0.478, -0.478, -0.483, -0.494, -0.508, 
                           -0.528, -0.551, -0.573, -0.599, -0.633, -0.668) * -1, 
                         0, c(-0.206, -0.193, -0.174, -0.149, -0.118, -0.085, 
                              -0.057, -0.034, -0.016, -0.008, 0.006, 0.026, 0.048, 
                              0.075, 0.099, 0.116, 0.116, 0.099, 0.075, 0.048, 
                              0.026, 0.006, -0.008, -0.016, -0.034, -0.057, -0.085, 
                              -0.118, -0.149, -0.174, -0.193, -0.206))
RedDrum$antenna <- cbind(c(0.03, 0.35, 0.35, 0.03) * -1, 0, c(-0.003,-0.003, 0.003, 0.003) + 0.22)

RedDrum$tag <- cbind(c(cos(seq(((3 * pi/2) - pi/2), ((5 * pi/2) +  pi/2), by = 0.05)) * 0.07) * -1,
                     0,
                     c(sin(seq(((3 * pi/2) -  pi/2), ((5 * pi/2) + pi/2), by = 0.05)) * 0.05) + 0.22)






Draw_XZ_3D<-function(x=1,y=1,pitch=0,roll=0,TBAng=0,phi=0,theta=0,exp=1,Animal=NULL){
  AnimalT<-list()
  for(i in 1:(length(Animal)-2)){
    AnimalT[[i]] <- BendFigureZ(X = Animal[[i+2]][, 1], Y = Animal[[i+2]][, 2], Z = Animal[[i+2]][,3], ang = TBAng)
    AnimalT[[i]] <- AnimalT[[i]] %*% Yb(pitch)
    AnimalT[[i]] <- AnimalT[[i]] %*% Xb(roll)
  }
  
  p<-perspbox(z=c(-1,1),phi=phi,theta=theta,xlim=c(-1,1),ylim=c(-1,1),zlim=c(-1,1),main="Title",plot=FALSE)
  
  Animal3D<-list()
  for(i in 1:length(AnimalT)){
    Animal3D[[i]]<-trans3d(x = AnimalT[[i]][, 1], y = AnimalT[[i]][, 2], z = AnimalT[[i]][,3],p)
  }
  
  op <- par()
  xdif <- op$usr[2] - par()$usr[1]
  ydif <- op$usr[4] - par()$usr[3]
  windasp <- op$pin[1]/op$pin[2]
  
  
  for(i in 1:length(Animal3D)){
    xlocs <- (Animal3D[[i]]$x * exp * (xdif/2)) + x
    ylocs <- (Animal3D[[i]]$y * exp * windasp * (ydif/2)) + y
    
    polygon(ylocs ~  xlocs,col=Animal$colors[i],border=Animal$borders[i])
  }
}